profiles {

	standard {
		process.executor = 'local'
	}

	cluster {
		process.executor = 'slurm' 
		process.scratch = true
		process.maxRetries     = 1
		process.errorStrategy  = 'retry'
		clusterOptions = {"-A $params.allocation"}


		process {
			withLabel: big_mem {
				cpus = { 8 * task.attempt }
				memory = { 52.GB * task.attempt }
				queue = 'core'
				time = { 3.h * task.attempt }
			}
			withLabel: mid_mem {
				cpus = { 4 * task.attempt }
				queue = 'core'
				time = { 3.h * task.attempt }
			}
			withLabel: small {
				cpus = { 1 * task.attempt }
				queue = 'core'
				time = { 1.h * task.attempt }

			}
		}
	}


	singularity {
		docker.enabled = false
		singularity.enabled = true
		process.executor = 'slurm' 

		// counter path
		//params.crisprcounterpath="/opt/myjar" // path to executable CrisprCounter.jar in container

		// singularity cache and library - hardcoded at the moment
		// singularity.libraryDir="/crex/proj/sllstore2017103/nbis5351/tst-cont/containers"
		// singularity.cacheDir="/crex/proj/sllstore2017103/nbis5351/tst-cont/containers"


		process {
			withName: report_RSL {
				container = 'docker://ewels/multiqc'
			}
			withName: fastqc {
				container = 'docker://staphb/fastqc'
			}

		}
	}
}




